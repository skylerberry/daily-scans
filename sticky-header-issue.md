# Sticky Header Issue

## Problem
When scrolling down in the table, the sticky headers (`<thead><th>`) get visually cut off. The top portion of the header row disappears, leaving only the bottom part visible. The header text and background appear clipped.

**When at top (no scroll):** Headers display correctly with full gray background and bottom border.

**When scrolled (sticky active):** Headers are partially cut off â€” the gray background doesn't fill the full height, and the bottom border appears to cut through the header content.

## Environment
- Site hosted on Netlify
- Table HTML generated by `momentum_scan.py` and embedded into site via JavaScript (`app.js` fetches the HTML and injects it into `#scan-content`)
- Using `position: sticky; top: 0;` on `<th>` elements

## Current CSS Structure

### In `momentum_scan.py` (generated HTML):
```css
thead th {
  padding: 10px 12px;
  text-align: left;
  font-size: 10px;
  font-weight: 600;
  color: #666666;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  background: transparent;
  white-space: nowrap;
  cursor: pointer;
  user-select: none;
  position: sticky;
  top: 0;
  z-index: 20;
}

thead th::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  background: #f8f8f8;
  border-bottom: 1px solid #e8e8e8;
  pointer-events: none;
  z-index: -1;
}
```

### In `site/style.css` (site overrides):
```css
#scan-content .table-wrapper {
  overflow-x: auto;
  max-height: 70vh;
  overflow-y: auto;
}

#scan-content table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
}

#scan-content thead th {
  padding: 10px 12px;
  text-align: left;
  font-size: 10px;
  font-weight: 600;
  color: #666;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  background: transparent;
  white-space: nowrap;
  cursor: pointer;
  user-select: none;
  position: sticky;
  top: 0;
  z-index: 20;
}

#scan-content thead th::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  background: #f8f8f8;
  border-bottom: 1px solid #e8e8e8;
  pointer-events: none;
  z-index: -1;
}
```

### Container styles:
```css
#scan-content {
  background: #fff;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  /* overflow: hidden was removed */
}

#scan-content .container {
  border: none;
  max-width: none;
  background: #ffffff;
}
```

## Fixes Already Attempted

### 1. Removed `overflow: hidden` from parent containers
**Rationale:** `overflow: hidden` on ancestors breaks `position: sticky` by creating a new containing block.

**Changes made:**
- Removed `overflow: hidden` from `.container` in `momentum_scan.py`
- Removed `overflow: hidden` from `#scan-content` in `site/style.css`

**Result:** Still broken.

### 2. Changed `border-collapse: collapse` to `border-collapse: separate`
**Rationale:** `border-collapse: collapse` can cause rendering issues with sticky headers.

**Changes made:**
- Set `border-collapse: separate; border-spacing: 0;` on the table

**Result:** Still broken.

### 3. Used `::after` pseudo-element for background/border
**Rationale:** The background and border on `<th>` itself may not "travel" properly with sticky positioning. Using a pseudo-element ensures the full background stays with the sticky element.

**Changes made:**
- Set `background: transparent` on `thead th`
- Added `thead th::after` with `position: absolute`, full coverage (`left/right/top/bottom: 0`), background color, border-bottom, and `z-index: -1`

**Result:** Still broken.

## HTML Structure
The scan HTML has this structure:
```html
<div class="container">
  <div class="header">...</div>  <!-- Hidden via CSS when embedded -->
  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>TICKER</th>
          <th>RS</th>
          ...
        </tr>
      </thead>
      <tbody>
        ...
      </tbody>
    </table>
  </div>
</div>
```

When embedded, the `.header` div is hidden with `display: none`.

## Embedding Method
In `app.js`, the scan HTML is fetched and the `.container` element is extracted and injected:
```javascript
const response = await fetch(`scans/${scanId}.html`);
const html = await response.text();
const parser = new DOMParser();
const doc = parser.parseFromString(html, 'text/html');
const container = doc.querySelector('.container');
// ... remove footer ...
scanContent.innerHTML = container.outerHTML;
```

## Live URL
https://unique-cupcake-bbbd71.netlify.app/

## What We Need
A fix that makes the sticky headers display their full background and border when scrolled, without any visual clipping.
